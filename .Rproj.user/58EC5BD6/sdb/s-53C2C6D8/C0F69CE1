{
    "collab_server" : "",
    "contents" : "###################################\n## Wij doen MEE                  ##\n## Rik van Heumen & Dillen Bruil ##\n## 30 January 2017               ##\n###################################\n\n# A function to calculate the shortest route from A to B over the \"higroads\" and \"cycleways\" defined \n# by Open Street Map\n\n\nfindRoute <- function (street_from, street_to){\n  \n  # Criteria which roads should be matched\n  crit <- way(tags(k == \"highway\" | k == \"cycleway\"))\n  \n  # Subset the roads \n  # May be deleted when not plotted\n  roads_loc <- subset(loc, way_ids=find(loc, crit))\n  roads <- find(roads_loc, way(tags(k == \"name\")))\n  roads <- find_down(loc, way(roads))\n  roads_loc <- subset(loc, ids = roads)\n  \n  # Find start node\n  road_start_node <- local({ \n    id <- find(loc, node(tags(v == street_from)))[1]\n    find_nearest_node(loc, id, crit)})\n  road_start <- subset(loc, node(road_start_node))\n  \n  # Find destination node\n  road_dest_node <- local({\n    id <- find(loc, node(tags(v == street_to)))[1]\n    find_nearest_node(loc, id, crit)})\n  road_dest <- subset(loc, node(road_dest_node))\n  \n  # Plotting\n  plot_nodes(loc, col = \"gray\", pch = \".\" )\n  plot_ways(roads_loc, add = T)\n  plot_nodes(roads_loc, add = T, col = \"black\", pch = \".\", cex = 2)\n  plot_nodes(road_start, add = T, col = \"red\", pch = \".\", cex = 6)\n  plot_nodes(road_dest, add = T, col = \"blue\", pch = \".\", cex = 6)\n  \n  # Making the graph\n  gr_loc <- as_igraph(roads_loc)\n\n  # Setting the start and destination nodes for the graph\n  istart <- as.character(road_start_node)\n  idest <- as.character(road_dest_node)\n  \n  # Create the shortest path\n  shortpath <- get.shortest.paths(gr_loc, istart, idest, mode=\"all\")[[1]]\n  for (i in shortpath){\n    shortpath_nodes <- as.numeric(V(gr_loc)[i]$name)\n  }\n  \n  # Find the nodes and ways needed for the shortest route\n  route_ids <- find_up(roads_loc, node(shortpath_nodes))\n  route <- subset(roads_loc, ids = route_ids)\n  \n  # Plot it to to previous plots\n  plot_nodes(route, add=T, col=\"green\", pch = \".\", cex = 4)\n  plot_ways(route, add=T, col=\"green\")\n  \n  return (route)\n}\n\n\n\n",
    "created" : 1485765048017.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "324751098",
    "id" : "C0F69CE1",
    "lastKnownWriteTime" : 1485874663,
    "last_content_update" : 1485874663074,
    "path" : "~/WUR/MEE/GeoScripting/Project/Rfunctions/findRoute.R",
    "project_path" : "Rfunctions/findRoute.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : true,
    "source_window" : "",
    "type" : "r_source"
}